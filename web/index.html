<!DOCTYPE html>
<html>

<head>
    <title>发版工具</title>
</head>

<body>
    <p>xxxxxxxxxxxx</p>

    <link rel="stylesheet" type="text/css" href="./themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="./themes/icon.css">

    <script src="./jquery/jquery.min.js"></script>
    <script src="./jquery/jquery.easyui.min.js"></script>

    <div style="padding:5px 0;">
        <a href="javascript:void(0)" class="easyui-linkbutton" onclick="onBuildNightly()">发布内网</a>
    </div>

    <script>

        var $$project = "shxd";
        var ws = new WebSocket("ws://172.25.0.242:8787");
        ws.onopen = function () {
            console.log("ws opened");
        }
        ws.onclose = function () {
            alert("与服务器链接断开");
        }

        ws.onmessage = function (msg) {
            if (msg.indexOf("alert:") == -1) {
                console.log("收到来自服务器的消息：" + msg.data);
            } else {
                alert(msg.substring(6));
            }
        }

        function onBuildNightly() {
            ws.send(`{"type":"build","target":"nightly","project":"${$$project}"}`);
        }
    </script>
</body>

</html>